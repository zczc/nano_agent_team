# nano_agent_team 进化分支使用指南

此分支（`evolve`）引入了基于多智能体的 **自我进化循环 (Self-Evolution Loop)** 功能。在该机制下，系统可以自主分析现有代码、发现可改进或新增的能力，并自动化地进行代码编写、测试和状态管理。每一步成功的功能迭代将自动隔离到新的独立分支中进行后续开发。

## 核心机制摘要

进化过程通过执行自动化脚本循环跑 `main.py --evolution` 来实现，流程如下：

1. **研究与规划**: 智能体 (Historian, Researcher, Auditor 等) 分析上下文（项目能力差距、历史进展等）并拟定这一轮的研发方向。
2. **代码实现与测试**: 修改现有文件或新增功能模块，并编写、运行对应的测试用例。
3. **版本控制与追踪**: 在新分支中提交（分支格式通常为 `evolution/r[轮数]-[时间戳]`），然后自动记录这一轮进化的结果（PASS 或 FAIL）。
4. **生成报告**: 生成该轮进化的具体 Markdown 报告文件，展示变更详情。

## 重要文件与目录

- **`evolve.sh`**: 触发自动化进化循环的主控脚本。负责环境隔离（保障分支切换的安全性）和多轮进化的调度。
- **`evolution_state.json`**: 持久化状态追踪器，记录当前的进化轮数（`current_round`）、历史成功的迭代（`history`）与失败记录（`failures`），以及当前和基准的 Git 分支。
- **`evolution_reports/`**: 存放每轮进化详情报告的目录。例如 `round_2_20260226_200500.md`，报告中记载了研发方向、变动列表、测试结果与下一步建议。

## 使用方法

### 1. 启动自动进化循环

在项目根目录下，执行以下命令即可启动连续的自我进化回路：

```bash
bash evolve.sh [max_rounds]
```
> **参数 `max_rounds`**：可选参数，设定进化的最大连续跑批轮数，默认为 20。如果你只想让它自行进化 5 轮后查看成果，运行 `bash evolve.sh 5` 即可。

脚本开始运行后，会进入循环环境，每轮运行完成后会展示当前的 `evolution_state.json` 的简要状态、近期的 Git Commit 等信息，并在每一轮后稍作休眠（Cooldown）进行下一轮。

### 2. 安全中断进化

如果由于某些原因你需要在此次自动进化循环尚未达到最大轮数前**提前停止并中断**，请在项目根目录下创建停止信号文件：

```bash
touch .evolution_stop
```

脚本会在当前运作的这一轮（Round）完结后检查此文件。如果发现存在该文件，将立刻输出安全中断的日志并清理信号文件，然后终止后续轮次，非常安全，不会导致当前轮次正在生成的代码出现断裂。

### 3. 查看进化成果

当你想要检查系统的自主更新：
- 阅读 `evolution_reports/` 目录下的 Markdown 文件，查看每一轮具体的思路、产生的变更与详细测试输出。
- 打开 `evolution_state.json` 查看其记录的整体历史记录，通过 `branch` 字段可以直接得知某一个被成功判定 (`"verdict": "PASS"`) 的特性分支（例如：`evolution/r2-20260226_195911`）。
- 使用 `git branch -a` 命令查看自动生成的各个细分迭代分支进行验证与验收合并。
